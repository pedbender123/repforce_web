{
  "entities": [
    {
      "name": "products",
      "display_name": "Produtos",
      "fields": [
        { "name": "name", "label": "Nome", "type": "text", "is_required": true },
        { "name": "price", "label": "Preço Unitário", "type": "currency" },
        { "name": "stock", "label": "Estoque", "type": "number" },
        { 
          "name": "info_alert", 
          "label": "Alerta de Estoque", 
          "type": "text", 
          "formula": "IF([stock] < 5, 'Baixo Estoque!', '')", 
          "is_virtual": true
        }
      ]
    },
    {
      "name": "sales",
      "display_name": "Vendas",
      "fields": [
        { "name": "product_id", "label": "Produto", "type": "lookup", "options": { "target": "products" } },
        { "name": "quantity", "label": "Quantidade", "type": "number" },
        { "name": "unit_price", "label": "Preço Unit.", "type": "currency" },
        { 
          "name": "total", 
          "label": "Total", 
          "type": "currency", 
          "formula": "[quantity] * [unit_price]", 
          "is_virtual": false 
        }
      ]
    }
  ],
  "navigation": [
    {
      "group": "Comercial",
      "pages": [
        {
          "name": "Lista de Produtos",
          "type": "list",
          "entity": "products"
        },
        {
          "name": "Detalhe do Produto",
          "type": "detail",
          "entity": "products",
          "layout_config": {
            "tabs": [
              {
                "label": "Histórico de Vendas",
                "source_table": "sales",
                "relation_key": "product_id",
                "columns": ["quantity", "unit_price", "total"]
              }
            ]
          }
        }
      ]
    }
  ]
}
